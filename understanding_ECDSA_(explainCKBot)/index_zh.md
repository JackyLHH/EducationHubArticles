---
title: '一文读懂 ECDSA：数字签名的安全支柱'
coverImage: 'images/image1.png'
category: Popular
subtitle: '椭圆曲线数字签名算法（ECDSA）是一种加密算法，为包括比特币和以太坊等加密货币在内的各种应用生成数字签名。'
date: '2023-08-28T16:00:00.000Z'
author: 
- github:explainCKBot
---

椭圆曲线数字签名算法（Elliptic Curve Digital Signature Algorithm，缩写：ECDSA）提供安全、高效的签名和验证流程，确保数据的完整性和真实性。本文将介绍 ECDSA 的基础知识、基本数学概念以及它在现代密码学中的应用。




## ECC 和 ECDSA

ECDSA 建立在椭圆曲线密码学（Elliptic Curve Cryptography，缩写：ECC）的基础之上，ECC 是一种基于有限域上椭圆曲线代数结构的公钥密码学方法。与 RSA（Rivest–Shamir–Adleman）等传统公钥加密技术相比，ECC 具有多项优势，包括密钥大小更小、计算速度更快，以及在给定密钥长度下安全性更高。

椭圆曲线由一个数学方程定义，其形式为 y^2 = x^3 + ax + b，其中 a 和 b 是常数。满足该等式的点（x，y）的集合，连同一个称为无穷远的特殊点，构成一个椭圆曲线组。ECC 的安全性依赖于离散对数问题，而在椭圆曲线上解决离散对数问题在计算上被认为是不可行的。




## 密钥生成

在 ECDSA 中，每个用户生成一个公私钥对，用于签署和验证数字签名。密钥生成的过程包括以下步骤：

- 选择一条合适的椭圆曲线，并取椭圆曲线上的一个点作为基点 G，n（一个大质数）为点 G 的阶。曲线参数 G 和 n 都是公开的并在所有用户之间共享。
- 从 [1, n-1] 范围内随机选择一个整数 d。整数 d 将作为私人密钥。
- 计算公钥 Q = dG，其中 Q 是曲线上的一个点。这一步的计算涉及标量乘法，这是 ECC 中的一个基本运算，重复将一个点与自身相加 d 次。



## 签名和验证

ECDSA 使用户能够为给定信息生成数字签名，该签名可由拥有签名者公钥的其他用户验证。签名和验证的过程包括以下几个步骤：

#### 签名：

* 使用哈希函数（例如 SHA256）对信息进行哈希处理，得到信息摘要 m。
* 从 [1, n-1] 范围内选择一个随机整数 k。
* 计算点 R = kG，并确定 R 的 x 坐标，记为 r。如果 r 等于 0，则为 k 选择不同的值并重复该过程。
* 计算 s = k^(-1)(m + rd) mod n 的值，其中 k^(-1) 是 k modulo n 的乘法逆元。如果 s 等于 0，则为 k 选择不同的值并重复该过程。
* 消息的数字签名由 (r, s) 对组成。


#### 验证：

* 使用相同的哈希函数对收到的信息进行哈希处理，得到信息摘要 m。
* 检查签名值 r 和 s 是否在 [1, n-1] 范围内。如果不在，则签名无效。
* 计算值 u1 = m * s^(-1) mod n 和 u2 = r * s^(-1) mod n，其中 s^(-1) 是 s modulo n 的乘法逆元。
* 计算点 P = u1 * G + u2 * Q。如果 P 等于无穷远处的点，则签名无效。
* 确定 P 的 x 坐标，记为 x_P。如果 x_P 等于 r，则签名有效，否则无效。



## 安全性与应用

ECDSA 的安全性源于椭圆曲线离散对数问题（ECDLP）的复杂性。该问题涉及给定椭圆曲线上的点 G 和 Q = dG 时确定标量值 "d"。在处理精心挑选的曲线和足够大的密钥规模时，ECDLP 被认为在计算上是不可行的，因此它不受已知攻击的影响。

ECDSA 最知名的应用之一是在比特币和以太坊等加密货币中的使用。作为数字签名算法，ECDSA 在提供安全、高效的交易签名和验证方面发挥着至关重要的作用，从而维护了区块链的完整性和真实性。

对于加密货币而言，ECDSA 是确保资金安全和交易真实性的关键组成部分。以比特币为例，ECDSA 允许用户使用私钥签署交易，然后由网络上的其他节点使用相应的公钥进行验证。这一过程保证了只有资金的合法拥有者才能发起交易，同时也确保了交易细节（如金额和收款人）在转账过程中保持不变。

除了加密货币，ECDSA 还被用于传输层安全（TLS）协议和安全外壳（SSH）协议等安全通信协议中。在这些情况下，ECDSA 用于验证客户端和服务器之间交换的信息。这种验证有助于确保参与通信的各方都是他们所声称的身份，并且所传输的数据没有被篡改。

最后，ECDSA 还被证书颁发机构（CA）用来签署数字证书。这样可以确认网站和其他数字实体的真实性和完整性，让用户相信他们正在与合法来源进行交互。



## 总结

ECDSA 是一种功能强大的加密算法，它利用椭圆曲线加密算法的优势提供安全、高效的数字签名方案。凭借其强大的安全性和广泛的应用范围，ECDSA 已成为现代密码学的重要组成部分，在确保数字通信和交易安全方面发挥着至关重要的作用。随着世界互联互通，对安全数字签名的需求日益增长，ECDSA 将继续成为保护数字信息完整性和真实性的重要工具。
